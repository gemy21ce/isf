<?phpinclude_once dirname(__FILE__) . '/../AdminGenericController.php';class Home extends AdminGenericController {    function __construct() {        parent::__construct(true, array("judge", "super_judge"));        $this->is_logged_in($this->session->userdata('usertype'));    }    function index() {        $model = new Project();        $schedule = new Schedule();        $judgemodel = new Judge();        $judgemodel->where("user_id", $this->session->userdata("id"));        $judge = $judgemodel->get();        $schedule->where("judge_id = ". $judge->id." and (eval_total = 0 || eval_total is null)");        $schedule->select("project_id");        $data["evalprojects"] = $schedule->get();        $model->order_by('id');        $data["projects"] = $model->get();        $data['main_content'] = 'frontend/judge/home_view';        $this->load->view('frontend/includes/template', $data);    }    function projects() {        $aColumns = array("id", "name", "team_leader_name", "school", "adult_sponsor_name");        $searchBy = array();        $model = new Project();        $orderCal = "id";        return $this->prepareTable($aColumns, $searchBy, $model, $orderCal);    }    function showproject() {        $projectid = $this->uri->segment(4);        $model = new Project();        $model->get_by_id($projectid);        if (!$model->id) {            show_404();            die;        }        $data["project"] = $model;        $data['main_content'] = 'frontend/judge/project_view';        $this->load->view('frontend/includes/template', $data);    }    function evaluateproject() {        $projectid = $this->uri->segment(4);        $model = new Project();        $model->get_by_id($projectid);        if (!$model->id) {            show_404();            die;        }        $judgemodel = new Judge();        $judgemodel->where("user_id", $this->session->userdata("id"));        $judge = $judgemodel->get();        $schedModel = new Schedule();        $schedModel->where("project_id = " . $projectid . " and judge_id = " . $judge->id);        $schedule = $schedModel->get();        if (!$schedule->id) {            show_404();            die;        }        $data["project"] = $model;        $data['main_content'] = 'frontend/judge/project_evaluate';        $this->load->view('frontend/includes/template', $data);    }    function evaluation() {        $projectId = $this->input->post("projectId");                $judgemodel = new Judge();                $judgemodel->where("user_id", $this->session->userdata("id"));        $judge = $judgemodel->get();        $schedModel = new Schedule();        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_1",$this->input->post("eval_q_1"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_2",$this->input->post("eval_q_2"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_3",$this->input->post("eval_q_3"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_4",$this->input->post("eval_q_4"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_5",$this->input->post("eval_q_5"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_q_6",$this->input->post("eval_q_6"));        $schedModel->where("project_id = " . $projectId . " and judge_id = " . $judge->id)->update("eval_total",$this->input->post("eval_total"));                redirect(base_url()."judge/home");    }    function schedule() {        $judgemodel = new Judge();        $judgemodel->where("user_id", $this->session->userdata("id"));        $judge = $judgemodel->get();        $schedModel = new Schedule();        $schedModel->where("judge_id = " . $judge->id);        $data["schedule"] = $schedModel->get();        $data['main_content'] = 'frontend/judge/judge_schedule';        $this->load->view('frontend/includes/template', $data);    }    protected function formatData($modelsResult) {        $data = array();        foreach ($modelsResult as $item) {            $item_data = array();            $item_data[] = $item->name;            $item_data[] = $item->team_leader_name;            $item_data[] = $item->school;            $item_data[] = $item->adult_sponsor_name;            $item_data[] = date('Y-m-d ', strtotime($item->start_date));            $item_data[] = date('Y-m-d ', strtotime($item->end_date));            $item_data[] = $item->id;            $item_data[] = $item->id;            $data[] = $item_data;        }        return $data;    }}?>